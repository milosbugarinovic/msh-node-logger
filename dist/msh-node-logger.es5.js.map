{"version":3,"file":"msh-node-logger.es5.js","sources":["../src/recovery-strategy/base-recovery-strategy.ts","../src/recovery-strategy/no-recovery.ts","../src/msh-node-logger.ts"],"sourcesContent":["export class BaseRecoveryStrategy {\n  private readonly __callBackFunctions: (() => void)[] = []\n\n  protected _addCallBackFunction(cb: () => void): void {\n    if (this.__callBackFunctions.indexOf(cb) === -1) this.__callBackFunctions.push(cb)\n  }\n  protected _triggerAllCallBackFunction(): void {\n    this.__callBackFunctions.forEach((cb) => cb())\n  }\n}\n","import { BaseRecoveryStrategy } from './base-recovery-strategy'\nimport { RecoveryStrategy } from './index'\n\nexport class NoRecovery extends BaseRecoveryStrategy implements RecoveryStrategy {\n  public startRecovery(): void {\n    return\n  }\n\n  public onRecovered(cb: () => void): void {\n    return\n  }\n}\n","import * as Transport from 'winston-transport'\nimport { RecoveryStrategy } from './recovery-strategy'\nimport { NoRecovery } from './recovery-strategy/no-recovery'\nimport { TransportStrategy } from './transport-strategy/'\n\nexport default class MshNodeLogger {\n  private __transportStrategy: TransportStrategy\n  private __recoveryStrategy: RecoveryStrategy\n\n  constructor(transactionStrategy: TransportStrategy, recoveryStrategy = new NoRecovery()) {\n    this.__transportStrategy = transactionStrategy\n    this.__recoveryStrategy = recoveryStrategy\n  }\n\n  public createTransport(): Transport {\n    const transport = this.__transportStrategy.create()\n    transport.on('error', () => {\n      this.__recoveryStrategy.startRecovery()\n    })\n    return transport\n  }\n  public onRecovered(cb: (transport: Transport) => void): void {\n    this.__recoveryStrategy.onRecovered(() => {\n      cb(this.createTransport())\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;IAAA;QACmB,wBAAmB,GAAmB,EAAE,CAAA;KAQ1D;IANW,mDAAoB,GAA9B,UAA+B,EAAc;QAC3C,IAAI,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAAE,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;KACnF;IACS,0DAA2B,GAArC;QACE,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,UAAC,EAAE,IAAK,OAAA,EAAE,EAAE,GAAA,CAAC,CAAA;KAC/C;IACH,2BAAC;AAAD,CAAC;;ACND;IAAgC,8BAAoB;IAApD;;KAQC;IAPQ,kCAAa,GAApB;QACE,OAAM;KACP;IAEM,gCAAW,GAAlB,UAAmB,EAAc;QAC/B,OAAM;KACP;IACH,iBAAC;AAAD,CARA,CAAgC,oBAAoB;;;ICMlD,uBAAY,mBAAsC,EAAE,gBAAmC;QAAnC,iCAAA,EAAA,uBAAuB,UAAU,EAAE;QACrF,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAA;QAC9C,IAAI,CAAC,kBAAkB,GAAG,gBAAgB,CAAA;KAC3C;IAEM,uCAAe,GAAtB;QAAA,iBAMC;QALC,IAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAA;QACnD,SAAS,CAAC,EAAE,CAAC,OAAO,EAAE;YACpB,KAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,CAAA;SACxC,CAAC,CAAA;QACF,OAAO,SAAS,CAAA;KACjB;IACM,mCAAW,GAAlB,UAAmB,EAAkC;QAArD,iBAIC;QAHC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC;YAClC,EAAE,CAAC,KAAI,CAAC,eAAe,EAAE,CAAC,CAAA;SAC3B,CAAC,CAAA;KACH;IACH,oBAAC;AAAD,CAAC;;;;"}