{"version":3,"file":"msh-node-logger.umd.js","sources":["../src/recovery-strategy/base-recovery-strategy.ts","../src/recovery-strategy/no-recovery.ts","../src/msh-node-logger.ts"],"sourcesContent":["export class BaseRecoveryStrategy {\n  private readonly __callBackFunctions: (() => void)[] = []\n\n  protected _addCallBackFunction(cb: () => void): void {\n    if (this.__callBackFunctions.indexOf(cb) === -1) this.__callBackFunctions.push(cb)\n  }\n  protected _triggerAllCallBackFunction(): void {\n    this.__callBackFunctions.forEach((cb) => cb())\n  }\n}\n","import { BaseRecoveryStrategy } from './base-recovery-strategy'\nimport { RecoveryStrategy } from './index'\n\nexport class NoRecovery extends BaseRecoveryStrategy implements RecoveryStrategy {\n  public startRecovery(): void {\n    return\n  }\n\n  public onRecovered(cb: () => void): void {\n    return\n  }\n}\n","import * as Transport from 'winston-transport'\nimport { RecoveryStrategy } from './recovery-strategy'\nimport { NoRecovery } from './recovery-strategy/no-recovery'\nimport { TransportStrategy } from './transport-strategy/'\n\nexport default class MshNodeLogger {\n  private __transportStrategy: TransportStrategy\n  private __recoveryStrategy: RecoveryStrategy\n\n  constructor(transactionStrategy: TransportStrategy, recoveryStrategy = new NoRecovery()) {\n    this.__transportStrategy = transactionStrategy\n    this.__recoveryStrategy = recoveryStrategy\n  }\n\n  public createTransport(): Transport {\n    const transport = this.__transportStrategy.create()\n    transport.on('error', () => {\n      this.__recoveryStrategy.startRecovery()\n    })\n    return transport\n  }\n  public onRecovered(cb: (transport: Transport) => void): void {\n    this.__recoveryStrategy.onRecovered(() => {\n      cb(this.createTransport())\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAA;QAAA;YACmB,wBAAmB,GAAmB,EAAE,CAAA;SAQ1D;QANW,mDAAoB,GAA9B,UAA+B,EAAc;YAC3C,IAAI,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;gBAAE,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;SACnF;QACS,0DAA2B,GAArC;YACE,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,UAAC,EAAE,IAAK,OAAA,EAAE,EAAE,GAAA,CAAC,CAAA;SAC/C;QACH,2BAAC;IAAD,CAAC;;ICND;QAAgC,8BAAoB;QAApD;;SAQC;QAPQ,kCAAa,GAApB;YACE,OAAM;SACP;QAEM,gCAAW,GAAlB,UAAmB,EAAc;YAC/B,OAAM;SACP;QACH,iBAAC;IAAD,CARA,CAAgC,oBAAoB;;;QCMlD,uBAAY,mBAAsC,EAAE,gBAAmC;YAAnC,iCAAA,EAAA,uBAAuB,UAAU,EAAE;YACrF,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAA;YAC9C,IAAI,CAAC,kBAAkB,GAAG,gBAAgB,CAAA;SAC3C;QAEM,uCAAe,GAAtB;YAAA,iBAMC;YALC,IAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAA;YACnD,SAAS,CAAC,EAAE,CAAC,OAAO,EAAE;gBACpB,KAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,CAAA;aACxC,CAAC,CAAA;YACF,OAAO,SAAS,CAAA;SACjB;QACM,mCAAW,GAAlB,UAAmB,EAAkC;YAArD,iBAIC;YAHC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC;gBAClC,EAAE,CAAC,KAAI,CAAC,eAAe,EAAE,CAAC,CAAA;aAC3B,CAAC,CAAA;SACH;QACH,oBAAC;IAAD,CAAC;;;;;;;;"}